
方法就是重点资讯 debug 5 遍，国家统计 debug 5 遍，然后开始写代码。  


### 国家列表速度优化  

仿照重点资讯的方法进行优化。  

基本上应该就是吃透重点资讯，然后再吃透国家文章列表现在的逻辑，然后再改国家文章列表。  


#### 重点资讯的优化方法  

原来速度慢的原因是在于，要把所有的文章标题全部都提取出来，然后在代码中进行文本处理和去重操作。  

所以改进速度最核心的一点就是在 ES 中进行去重操作，这样的好处是：1、不用等待全部加载完成以后才能处理；2、不用在代码里进行各种处理和去重；3、可以只提取一部分数据；  



#### 国家文章列表的优化方法  

国家列表的优化应该也差不多。核心就是在 ES 里进行去重操作。  

难点：国家列表和重点资讯的不同点在于国家列表有两个去重：一个标题去重，这一部分和重点资讯是一样的；一个是显示文章内容去重。  

解决步骤，先做和重点资讯相同的第一部分  


第一步：吃透重点资讯。  

重点资讯在 views.py 中是 SearchView 类中的 important_posts 函数。  

在 important_posts 函数中都是一些常规配置，没有什么功能性的代码，核心在 importantSearchMiddleware 中。  

importantSearchMiddleware：核心在 es 方法中。  

读 es 方法，es 方法中，前一部分是缓存，后面一部分是 es 查询。  

先读后面一部分。  







#### 问题：  

解决思路：  






拆解，一个一个来，不要全部一起解决  

先实现最简单的功能，然后再实现第二简单的功能  

